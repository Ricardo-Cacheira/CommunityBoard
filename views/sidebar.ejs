<div class="left" id="sidebar">
    <img class="profile-pic circular--square" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRA3sT9gBpKnl_cJRDOqrq-_NiwosIBY_eHuisQ_Kj8SkABMqaw"
    />
    <a href="/feed/<%- community %>">
        <p class="name">
            <%- communityName %>
        </p>
    </a>
    <p class="bio">
        Group of 
        <%- communityName %>
    </p>
    <a id="new" class="button" href="#popup1">NEW POST</a>
    <% if(role == 1){ %>
        <a id="join" class="button" href="#popup2">JOIN REQUESTS</a>
    <% } %>
    <a id="members" class="button" href="#popup3">Members</a>
</div>

<% if(role == 1){ %>
    <div id="popup2" class="overlay">
        <div class="popup">
            <a class="close" href="#">&times;</a>
            <p>LIST OF USERS WHO REQUESTED TO JOIN</p>
            <table class="content table">
                <tr>
                    <th style="width: 80%">User info</th>
                    <th style="width: 20%">Accept</th>
                </tr>
                <% for (let i = 0; i < requests.length; i++) { %>
                    <% var element = requests[i]; %>
                    <tr>
                        <td><%= element.firstName + " " + element.lastName +" UserName: "+ element.userName%></td>
                        <td>
                                <div onclick="acceptRequest(this.id, <%=community %>);" id="<%= element.id %>">Accept Request</div>
                        </td>
                    </tr>
                <% } %>
            </table>
        </div>
    </div>
<% } %>

<div id="popup3" class="overlay">
    <div class="popup">
        <a class="close" href="#">&times;</a>
        <b>List of users in this community</b>
        <table class="content table">
            <tr>
                <th style="width: 60%">Name</th>
                <th style="width: 40%">UserName</th>
            </tr>
            <% for (let i = 0; i < members.length; i++) { %>
                <% var element = members[i]; %>
                <tr>
                    <td><%= element.firstName + " " + element.lastName%></td>
                    <td>
                        <%= element.userName %>
                    </td>
                </tr>
            <% } %>
        </table>
    </div>
</div>


<div id="popup1" class="overlay">
    <div class="popup">
        <a class="close" href="#">&times;</a>
        <div class="content">
            <form method="POST" id="postform" action='/newp'>
                <h2>Create a new Post</h2>
                <p>What do you need help with?</p>
                <br>
                <textarea required type="content" id="content" name="content" style="resize: none;" cols="40" rows="5" placeholder="Don't give unnecessary information    Doing so might compromise your safety"></textarea>
                <br>Due Date:
                <br>
                <input type="datetime-local" name="dato" id="dato">
                <input style="visibility:hidden;" type="text" name="comID" id="comID" value="<%-community %>">
                <br>
                <button type="submit" class="btn btn-primary" id="submit"> SUBMIT </button>
            </form>
        </div>
    </div>
</div>
<script>
    $(function () {
        var dtToday = new Date();

        var month = dtToday.getMonth() + 1;
        var day = dtToday.getDate();
        var year = dtToday.getFullYear();
        var hours = dtToday.getHours();
        var min = dtToday.getMinutes();
        if (month < 10)
            month = '0' + month.toString();
        if (day < 10)
            day = '0' + day.toString();

        var maxDate = year + '-' + month + '-' + day + "T" + hours + ":" + min;
        console.log(maxDate);
        $('#dato').attr('min', maxDate);
    });
</script>
